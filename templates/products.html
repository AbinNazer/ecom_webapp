{% extends "base.html" %}
{% block content %}

<h2 class="title">üõç Products</h2>

<div class="filters">
  <form method="get" action="/products" class="filter-form">
    <input type="text" name="search" placeholder="Search products..." value="{{ request.args.get('search', '') }}">
    <select name="category">
      <option value="">All Categories</option>
      {% for cat in categories %}
      <option value="{{ cat }}" {% if request.args.get('category') == cat %}selected{% endif %}>{{ cat }}</option>
      {% endfor %}
    </select>
    <button type="submit">Filter</button>
  </form>
</div>

<div class="grid">
  {% for product in products %}
  <div class="card">
    <img src="{{ product.image }}" alt="{{ product.name }}">
    {% if product.discount %}
    <span class="discount-badge">-{{ product.discount }}%</span>
    {% endif %}
    <h3>{{ product.name }}</h3>
    <p class="price">‚Çπ{{ product.price }}
      {% if product.original_price %}
      <span class="old-price">‚Çπ{{ product.original_price }}</span>
      {% endif %}
    </p>
    <div class="rating">
      {% for i in range(1,6) %}
        {% if i <= product.rating %}‚òÖ{% else %}‚òÜ{% endif %}
      {% endfor %}
    </div>
    <a href="/add_to_cart/{{ product.id }}" class="btn add-btn">Add to Cart üõí</a>
  </div>
  {% endfor %}
</div>

<style>
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 20px;
}
.card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 3px 6px rgba(0,0,0,0.1);
  overflow: hidden;
  transition: transform 0.2s;
}
.card:hover { transform: translateY(-5px); }
.card img {
  width: 100%;
  height: 180px;
  object-fit: cover;
}
.discount-badge {
  position: absolute;
  top: 8px;
  left: 8px;
  background: #ff4d4d;
  color: white;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 0.8rem;
}
.price { font-weight: bold; font-size: 1.1rem; }
.old-price { text-decoration: line-through; color: #888; margin-left: 6px; }
.rating { color: #fbc02d; margin: 4px 0; }
.add-btn {
  display: inline-block;
  background: #28a745;
  color: white;
  padding: 8px 10px;
  border-radius: 6px;
  text-decoration: none;
  text-align: center;
}
.add-btn:hover { background: #218838; }
</style>
{% endblock %}
